library(psych)
library(arules)
library(party)
library(caret)
library(readxl)
library(DT)
library(dplyr)
library(cluster)
library(factoextra)
library(NbClust)
library(class)
library(naivebayes)
library(OneR)
setwd("D:/Downloads")
data <- read.csv("echocardiogram.data", header=F)
data <- data[, -c(9,10,11,12)]
data <- data[c(5,11,15,17,18,19,20,21,22,23,24,29,31,32,33,38,45,47,48,49,52,53,56,65,68,72,78,79,85,86,88,89,91,92,96,98,100,101,106,110,111,120,129), ]
data <- data[, -c(2)]
data$V1 <- as.factor(data$V1)
data$V3 <- as.factor(data$V3)
data$V5 <- as.factor(data$V5)
data$V6 <- as.factor(data$V6)
data$V7 <- as.factor(data$V7)
data$V8 <- as.factor(data$V8)
data$V13 <- as.factor(data$V13)
str(data)
summary(data)
data <- na_if(data, "?")
sapply(data, function(x) sum(is.na(x)))
data_naomit <- na.omit(data)
sapply(data_naomit, function(x) sum(is.na(x)))
set.seed(1234)
sampel <- sample(2,nrow(data_naomit),replace = T, prob = c(0.8,0.2))
trainingdat <- data_naomit[sampel==1, ]
testingdat<- data_naomit[sampel==2, ]
print(paste("Jumlah Train Data: ", nrow(trainingdat), "| Jumlah Test Data: ", nrow(testingdat)))
prediksi <- knn(train = trainingdat, test = testingdat, cl=trainingdat$V13, k=19)
confusionMatrix(table(prediksi, testingdat$V13))